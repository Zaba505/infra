<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/infra/pr-preview/pr-626/favicons/favicon.ico><link rel=apple-touch-icon href=/infra/pr-preview/pr-626/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/infra/pr-preview/pr-626/favicons/android-192x192.png sizes=192x192><title>[0003] Cloud Provider Selection for Network Boot Infrastructure | Zaba505's Home Lab</title><meta name=description content="Evaluate Google Cloud Platform vs Amazon Web Services for hosting network boot server infrastructure as required by ADR-0002."><meta property="og:url" content="https://zaba505.github.io/infra/pr-preview/pr-626/rd/adrs/0003-cloud-provider-selection/"><meta property="og:site_name" content="Zaba505's Home Lab"><meta property="og:title" content="[0003] Cloud Provider Selection for Network Boot Infrastructure"><meta property="og:description" content="Evaluate Google Cloud Platform vs Amazon Web Services for hosting network boot server infrastructure as required by ADR-0002."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="r&amp;d"><meta property="article:published_time" content="2025-11-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-23T21:05:19-05:00"><meta itemprop=name content="[0003] Cloud Provider Selection for Network Boot Infrastructure"><meta itemprop=description content="Evaluate Google Cloud Platform vs Amazon Web Services for hosting network boot server infrastructure as required by ADR-0002."><meta itemprop=datePublished content="2025-11-17T00:00:00+00:00"><meta itemprop=dateModified content="2025-11-23T21:05:19-05:00"><meta itemprop=wordCount content="1722"><meta name=twitter:card content="summary"><meta name=twitter:title content="[0003] Cloud Provider Selection for Network Boot Infrastructure"><meta name=twitter:description content="Evaluate Google Cloud Platform vs Amazon Web Services for hosting network boot server infrastructure as required by ADR-0002."><link rel=preload href=/infra/pr-preview/pr-626/scss/main.min.74eef40c5172b0e2f11bd9c3ea40dba66c2dc642ac5294c208f5dc9ff772c0e9.css as=style integrity="sha256-dO70DFFysOLxG9nD6kDbpmwtxkKsUpTCCPXcn/dywOk=" crossorigin=anonymous><link href=/infra/pr-preview/pr-626/scss/main.min.74eef40c5172b0e2f11bd9c3ea40dba66c2dc642ac5294c208f5dc9ff772c0e9.css rel=stylesheet integrity="sha256-dO70DFFysOLxG9nD6kDbpmwtxkKsUpTCCPXcn/dywOk=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/infra/pr-preview/pr-626/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Zaba505's Home Lab</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class="td-light-dark-menu nav-item dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/infra/pr-preview/pr-626/offline-search-index.5666dd9f2af9195d0a6269b05b36e30d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/infra/pr-preview/pr-626/offline-search-index.5666dd9f2af9195d0a6269b05b36e30d.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-infrapr-previewpr-626-li><a href=/infra/pr-preview/pr-626/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-infrapr-previewpr-626><span>Zaba505's Home Lab</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626physical_infrastructure-li><a href=/infra/pr-preview/pr-626/physical_infrastructure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626physical_infrastructure><span>Physical Infrastructure</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-infrapr-previewpr-626rd-li><a href=/infra/pr-preview/pr-626/rd/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rd><span>Research and Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-infrapr-previewpr-626rdanalysis-li><a href=/infra/pr-preview/pr-626/rd/analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysis><span>Technology Analysis</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysisresource_identification-li><a href=/infra/pr-preview/pr-626/rd/analysis/resource_identification/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysisresource_identification><span>Resource Identifiers Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisresource_identificationuuid-li><a href=/infra/pr-preview/pr-626/rd/analysis/resource_identification/uuid/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisresource_identificationuuid><span>Universally Unique Identifier (UUID) Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisresource_identificationulid-li><a href=/infra/pr-preview/pr-626/rd/analysis/resource_identification/ulid/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisresource_identificationulid><span>Universally Unique Lexicographically Sortable Identifier (ULID) Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisresource_identificationsnowflake-li><a href=/infra/pr-preview/pr-626/rd/analysis/resource_identification/snowflake/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisresource_identificationsnowflake><span>Snowflake ID Analysis</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysisserver-os-li><a href=/infra/pr-preview/pr-626/rd/analysis/server-os/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysisserver-os><span>Server Operating System Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisserver-osubuntu-li><a href=/infra/pr-preview/pr-626/rd/analysis/server-os/ubuntu/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisserver-osubuntu><span>Ubuntu Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisserver-osfedora-li><a href=/infra/pr-preview/pr-626/rd/analysis/server-os/fedora/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisserver-osfedora><span>Fedora Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisserver-ostalos-linux-li><a href=/infra/pr-preview/pr-626/rd/analysis/server-os/talos-linux/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisserver-ostalos-linux><span>Talos Linux Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisserver-osharvester-li><a href=/infra/pr-preview/pr-626/rd/analysis/server-os/harvester/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisserver-osharvester><span>Harvester Analysis</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysisaws-li><a href=/infra/pr-preview/pr-626/rd/analysis/aws/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysisaws><span>Amazon Web Services Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisawsnetwork-boot-li><a href=/infra/pr-preview/pr-626/rd/analysis/aws/network-boot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisawsnetwork-boot><span>AWS Network Boot Protocol Support</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisawswireguard-li><a href=/infra/pr-preview/pr-626/rd/analysis/aws/wireguard/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisawswireguard><span>AWS WireGuard VPN Support</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysisgoogle-cloud-li><a href=/infra/pr-preview/pr-626/rd/analysis/google-cloud/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysisgoogle-cloud><span>Google Cloud Platform Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudgcsfuse-li><a href=/infra/pr-preview/pr-626/rd/analysis/google-cloud/gcsfuse/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudgcsfuse><span>Cloud Storage FUSE (gcsfuse)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudnetwork-boot-li><a href=/infra/pr-preview/pr-626/rd/analysis/google-cloud/network-boot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudnetwork-boot><span>GCP Network Boot Protocol Support</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudwireguard-li><a href=/infra/pr-preview/pr-626/rd/analysis/google-cloud/wireguard/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisgoogle-cloudwireguard><span>GCP WireGuard VPN Support</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9-li><a href=/infra/pr-preview/pr-626/rd/analysis/hp_dl360_gen9/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9><span>HP ProLiant DL360 Gen9 Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9configuration-li><a href=/infra/pr-preview/pr-626/rd/analysis/hp_dl360_gen9/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9configuration><span>Configuration Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9specifications-li><a href=/infra/pr-preview/pr-626/rd/analysis/hp_dl360_gen9/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9specifications><span>Hardware Specifications</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9network-boot-li><a href=/infra/pr-preview/pr-626/rd/analysis/hp_dl360_gen9/network-boot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysishp_dl360_gen9network-boot><span>Network Boot Capabilities</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysismatchbox-li><a href=/infra/pr-preview/pr-626/rd/analysis/matchbox/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysismatchbox><span>Matchbox Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysismatchboxconfiguration-li><a href=/infra/pr-preview/pr-626/rd/analysis/matchbox/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysismatchboxconfiguration><span>Configuration Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysismatchboxdeployment-li><a href=/infra/pr-preview/pr-626/rd/analysis/matchbox/deployment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysismatchboxdeployment><span>Deployment Patterns</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysismatchboxnetwork-boot-li><a href=/infra/pr-preview/pr-626/rd/analysis/matchbox/network-boot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysismatchboxnetwork-boot><span>Network Boot Support</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysismatchboxevaluation-li><a href=/infra/pr-preview/pr-626/rd/analysis/matchbox/evaluation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysismatchboxevaluation><span>Use Case Evaluation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdanalysisudm_pro-li><a href=/infra/pr-preview/pr-626/rd/analysis/udm_pro/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdanalysisudm_pro><span>Ubiquiti Dream Machine Pro Analysis</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdanalysisudm_provlans-li><a href=/infra/pr-preview/pr-626/rd/analysis/udm_pro/vlans/ title="UDM Pro VLAN Configuration & Capabilities" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdanalysisudm_provlans><span>VLANs</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-infrapr-previewpr-626rdadrs-li><a href=/infra/pr-preview/pr-626/rd/adrs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdadrs><span>Architecture Decision Records</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0001-use-madr-for-architecture-decision-records-li><a href=/infra/pr-preview/pr-626/rd/adrs/0001-use-madr-for-architecture-decision-records/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0001-use-madr-for-architecture-decision-records><span>[0001] Use MADR for Architecture Decision Records</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0002-network-boot-architecture-li><a href=/infra/pr-preview/pr-626/rd/adrs/0002-network-boot-architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0002-network-boot-architecture><span>[0002] Network Boot Architecture for Home Lab</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-infrapr-previewpr-626rdadrs0003-cloud-provider-selection-li><a href=/infra/pr-preview/pr-626/rd/adrs/0003-cloud-provider-selection/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0003-cloud-provider-selection><span class=td-sidebar-nav-active-item>[0003] Cloud Provider Selection for Network Boot Infrastructure</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0004-server-operating-system-li><a href=/infra/pr-preview/pr-626/rd/adrs/0004-server-operating-system/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0004-server-operating-system><span>[0004] Server Operating System Selection</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0005-network-boot-infrastructure-gcp-li><a href=/infra/pr-preview/pr-626/rd/adrs/0005-network-boot-infrastructure-gcp/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0005-network-boot-infrastructure-gcp><span>[0005] Network Boot Infrastructure Implementation on Google Cloud</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0006-resource-identifier-standard-li><a href=/infra/pr-preview/pr-626/rd/adrs/0006-resource-identifier-standard/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0006-resource-identifier-standard><span>[0006] Universal Resource Identifier Standard</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-infrapr-previewpr-626rdadrs0007-standard-api-error-response-li><a href=/infra/pr-preview/pr-626/rd/adrs/0007-standard-api-error-response/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdadrs0007-standard-api-error-response><span>[0007] Standard API Error Response Format</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-infrapr-previewpr-626rdservices-li><a href=/infra/pr-preview/pr-626/rd/services/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdservices><span>Services</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdservicesboot-li><a href=/infra/pr-preview/pr-626/rd/services/boot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdservicesboot><span>Boot Service</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootboot-ipxe-li><a href=/infra/pr-preview/pr-626/rd/services/boot/boot-ipxe/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootboot-ipxe><span>GET /boot.ipxe</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootasset-kernel-li><a href=/infra/pr-preview/pr-626/rd/services/boot/asset-kernel/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootasset-kernel><span>GET /asset/{boot_profile_id}/kernel</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootasset-initrd-li><a href=/infra/pr-preview/pr-626/rd/services/boot/asset-initrd/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootasset-initrd><span>GET /asset/{boot_profile_id}/initrd</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootpost-profiles-li><a href=/infra/pr-preview/pr-626/rd/services/boot/post-profiles/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootpost-profiles><span>POST /api/v1/profiles</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootget-profile-li><a href=/infra/pr-preview/pr-626/rd/services/boot/get-profile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootget-profile><span>GET /api/v1/boot/{machine_id}/profile</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootput-profile-li><a href=/infra/pr-preview/pr-626/rd/services/boot/put-profile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootput-profile><span>PUT /api/v1/boot/{machine_id}/profile</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesbootdelete-profile-li><a href=/infra/pr-preview/pr-626/rd/services/boot/delete-profile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesbootdelete-profile><span>DELETE /api/v1/boot/{machine_id}/profile</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesboothealth-startup-li><a href=/infra/pr-preview/pr-626/rd/services/boot/health-startup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesboothealth-startup><span>GET /health/startup</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesboothealth-liveness-li><a href=/infra/pr-preview/pr-626/rd/services/boot/health-liveness/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesboothealth-liveness><span>GET /health/liveness</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmt-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-infrapr-previewpr-626rdservicesmachine-mgmt><span>Machine Service</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmtpost-machines-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/post-machines/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesmachine-mgmtpost-machines><span>POST /api/v1/machines</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmtget-machines-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/get-machines/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesmachine-mgmtget-machines><span>GET /api/v1/machines</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmtget-machine-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/get-machine/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesmachine-mgmtget-machine><span>GET /api/v1/machines/{id}</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmtput-machine-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/put-machine/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesmachine-mgmtput-machine><span>PUT /api/v1/machines/{id}</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-infrapr-previewpr-626rdservicesmachine-mgmtdelete-machine-li><a href=/infra/pr-preview/pr-626/rd/services/machine-mgmt/delete-machine/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-infrapr-previewpr-626rdservicesmachine-mgmtdelete-machine><span>DELETE /api/v1/machines/{id}</span></a></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/Zaba505/infra/tree/main/content/r&amp;d/adrs/0003-cloud-provider-selection.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/Zaba505/infra/edit/main/content/r&amp;d/adrs/0003-cloud-provider-selection.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/Zaba505/infra/new/main/content/r&amp;d/adrs?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/Zaba505/infra/issues/new?title=[0003]%20Cloud%20Provider%20Selection%20for%20Network%20Boot%20Infrastructure" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/Zaba505/infra/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=/infra/pr-preview/pr-626/_print/rd/adrs/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#context-and-problem-statement>Context and Problem Statement</a></li><li><a href=#decision-drivers>Decision Drivers</a></li><li><a href=#considered-options>Considered Options</a></li><li><a href=#decision-outcome>Decision Outcome</a><ul><li><a href=#consequences>Consequences</a></li><li><a href=#confirmation>Confirmation</a></li></ul></li><li><a href=#pros-and-cons-of-the-options>Pros and Cons of the Options</a><ul><li><a href=#option-1-google-cloud-platform-gcp>Option 1: Google Cloud Platform (GCP)</a></li><li><a href=#option-2-amazon-web-services-aws>Option 2: Amazon Web Services (AWS)</a></li></ul></li><li><a href=#more-information>More Information</a><ul><li><a href=#detailed-analysis>Detailed Analysis</a></li><li><a href=#key-findings-summary>Key Findings Summary</a></li><li><a href=#cost-comparison-table>Cost Comparison Table</a></li><li><a href=#protocol-support-comparison>Protocol Support Comparison</a></li><li><a href=#wireguard-deployment-comparison>WireGuard Deployment Comparison</a></li><li><a href=#trade-offs-analysis>Trade-offs Analysis</a></li><li><a href=#related-adrs>Related ADRs</a></li><li><a href=#future-considerations>Future Considerations</a></li><li><a href=#related-issues>Related Issues</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/infra/pr-preview/pr-626/rd/>Research and Development</a></li><li class=breadcrumb-item><a href=/infra/pr-preview/pr-626/rd/adrs/>Architecture Decision Records</a></li><li class="breadcrumb-item active" aria-current=page>[0003] Cloud Provider Selection for Network Boot Infrastructure</li></ol></nav><div class=td-content><h1>[0003] Cloud Provider Selection for Network Boot Infrastructure</h1><div class=lead>Evaluate Google Cloud Platform vs Amazon Web Services for hosting network boot server infrastructure as required by ADR-0002.</div><header class=article-meta></header><h2 id=context-and-problem-statement>Context and Problem Statement</h2><p><a href=./0002-network-boot-architecture/>ADR-0002</a> established that network boot infrastructure will be hosted on a cloud provider and accessed via VPN (specifically WireGuard from the UDM Pro). The decision to use cloud hosting provides resilience against local hardware failures while maintaining security through encrypted VPN tunnels.</p><p>The question now is: <strong>Which cloud provider should host the network boot infrastructure?</strong></p><p>This decision will affect:</p><ul><li><strong>Cost</strong>: Ongoing monthly/annual infrastructure costs</li><li><strong>Protocol Support</strong>: Ability to serve TFTP, HTTP, and HTTPS boot files</li><li><strong>VPN Integration</strong>: Ease of WireGuard deployment and management</li><li><strong>Operational Complexity</strong>: Management overhead and maintenance burden</li><li><strong>Performance</strong>: Boot file transfer latency and throughput</li><li><strong>Vendor Lock-in</strong>: Future flexibility to migrate or multi-cloud</li></ul><h2 id=decision-drivers>Decision Drivers</h2><ul><li><strong>Cost Efficiency</strong>: Minimize ongoing infrastructure costs for home lab scale</li><li><strong>Protocol Support</strong>: Must support TFTP (UDP/69), HTTP (TCP/80), and HTTPS (TCP/443) for network boot workflows</li><li><strong>WireGuard Compatibility</strong>: Must support self-managed WireGuard VPN with reasonable effort</li><li><strong>UDM Pro Integration</strong>: Should work seamlessly with UniFi Dream Machine Pro&rsquo;s native WireGuard client</li><li><strong>Simplicity</strong>: Minimize operational complexity for a single-person home lab</li><li><strong>Existing Expertise</strong>: Leverage existing team knowledge and infrastructure</li><li><strong>Performance</strong>: Sufficient throughput and low latency for boot file transfers (50-200MB per boot)</li></ul><h2 id=considered-options>Considered Options</h2><ul><li><strong>Option 1</strong>: Google Cloud Platform (GCP)</li><li><strong>Option 2</strong>: Amazon Web Services (AWS)</li></ul><h2 id=decision-outcome>Decision Outcome</h2><p>Chosen option: &ldquo;<strong>Option 1: Google Cloud Platform (GCP)</strong>&rdquo;, because:</p><ol><li><strong>Existing Infrastructure</strong>: The home lab already uses GCP extensively (Cloud Run services, load balancers, mTLS infrastructure per existing codebase), reducing operational overhead and leveraging existing expertise</li><li><strong>Comparable Costs</strong>: Both providers offer similar costs for the required infrastructure (~$6-12/month for compute + VPN), with GCP&rsquo;s e2-micro being sufficient</li><li><strong>Equivalent Protocol Support</strong>: Both support TFTP/HTTP/HTTPS via direct VM access (load balancers unnecessary for single boot server), meeting all protocol requirements</li><li><strong>WireGuard Compatibility</strong>: Both require self-managed WireGuard deployment (neither has native WireGuard support), with nearly identical implementation complexity</li><li><strong>Unified Management</strong>: Consolidating all cloud infrastructure on GCP simplifies monitoring, billing, IAM, and operational workflows</li></ol><p>While AWS would be a viable alternative (especially with t4g.micro ARM instances offering slightly better price/performance), the <strong>existing GCP investment</strong> makes it the pragmatic choice to avoid multi-cloud complexity.</p><h3 id=consequences>Consequences</h3><ul><li>Good, because consolidates all cloud infrastructure on a single provider (reduced operational complexity)</li><li>Good, because leverages existing GCP expertise and IAM configurations</li><li>Good, because unified Cloud Monitoring/Logging across all services</li><li>Good, because single cloud bill simplifies cost tracking</li><li>Good, because existing Terraform modules and patterns can be reused</li><li>Good, because GCP&rsquo;s e2-micro instances (~$6.50/month) are cost-effective for the workload</li><li>Good, because self-managed WireGuard provides flexibility and low cost (~$10/month total)</li><li>Neutral, because both providers have comparable protocol support (TFTP/HTTP/HTTPS via VM)</li><li>Neutral, because both require self-managed WireGuard (no native support)</li><li>Bad, because creates vendor lock-in to GCP (migration would require relearning and reconfiguration)</li><li>Bad, because foregoes AWS&rsquo;s slightly cheaper t4g.micro ARM instances (~$6/month vs GCP&rsquo;s ~$6.50/month)</li><li>Bad, because multi-cloud strategy could provide redundancy (accepted trade-off for simplicity)</li></ul><h3 id=confirmation>Confirmation</h3><p>The implementation will be confirmed by:</p><ul><li>Successfully deploying WireGuard VPN gateway on GCP Compute Engine</li><li>Establishing site-to-site VPN tunnel between UDM Pro and GCP</li><li>Network booting a test server via VPN using TFTP and HTTP protocols</li><li>Measuring actual costs against estimates (~$10-15/month)</li><li>Validating boot performance (transfer time &lt; 30 seconds for typical boot)</li></ul><h2 id=pros-and-cons-of-the-options>Pros and Cons of the Options</h2><h3 id=option-1-google-cloud-platform-gcp>Option 1: Google Cloud Platform (GCP)</h3><p>Host network boot infrastructure on Google Cloud Platform.</p><h4 id=architecture-overview>Architecture Overview</h4><pre class=mermaid>graph TB
    subgraph &#34;Home Lab Network&#34;
        A[Home Lab Servers]
        B[UDM Pro - WireGuard Client]
    end
    
    subgraph &#34;GCP VPC&#34;
        C[WireGuard Gateway VM&lt;br/&gt;e2-micro]
        D[Boot Server VM&lt;br/&gt;e2-micro]
        C --&gt;|VPC Routing| D
    end
    
    A --&gt;|PXE Boot Request| B
    B --&gt;|WireGuard Tunnel| C
    C --&gt;|TFTP/HTTP/HTTPS| D
    D --&gt;|Boot Files| C
    C --&gt;|Encrypted Response| B
    B --&gt;|Boot Files| A</pre><h4 id=implementation-details>Implementation Details</h4><p><strong>Compute</strong>:</p><ul><li><strong>WireGuard Gateway</strong>: e2-micro VM (~$6.50/month) running Ubuntu 22.04<ul><li>Self-managed WireGuard server</li><li>IP forwarding enabled</li><li>Static external IP (~$3.50/month if VM ever stops)</li></ul></li><li><strong>Boot Server</strong>: e2-micro VM (same or consolidated with gateway)<ul><li>TFTP server (<code>tftpd-hpa</code>)</li><li>HTTP server (nginx or simple Python server)</li><li>Optional HTTPS with self-signed cert or Let&rsquo;s Encrypt</li></ul></li></ul><p><strong>Networking</strong>:</p><ul><li><strong>VPC</strong>: Default VPC or custom VPC with private subnets</li><li><strong>Firewall Rules</strong>:<ul><li>Allow UDP/51820 from home lab public IP (WireGuard)</li><li>Allow UDP/69, TCP/80, TCP/443 from VPN subnet (boot protocols)</li></ul></li><li><strong>Routes</strong>: Custom route to direct home lab subnet through WireGuard gateway</li><li><strong>Cloud VPN</strong>: Not used (self-managed WireGuard instead to save ~$65/month)</li></ul><p><strong>WireGuard Setup</strong>:</p><ul><li>Install WireGuard on Compute Engine VM</li><li>Configure <code>wg0</code> interface with PostUp/PostDown iptables rules</li><li>Store private key in Secret Manager</li><li>UDM Pro connects as WireGuard peer</li></ul><p><strong>Cost Breakdown</strong> (US regions):</p><table><thead><tr><th>Component</th><th>Monthly Cost</th></tr></thead><tbody><tr><td>e2-micro VM (WireGuard + Boot)</td><td>~$6.50</td></tr><tr><td>Static External IP (if attached)</td><td>~$3.50</td></tr><tr><td>Egress (10 boots × 150MB)</td><td>~$0.18</td></tr><tr><td><strong>Total</strong></td><td><strong>~$10.18</strong></td></tr><tr><td><strong>Annual</strong></td><td><strong>~$122</strong></td></tr></tbody></table><h4 id=pros-and-cons>Pros and Cons</h4><ul><li>Good, because existing home lab infrastructure already uses GCP extensively</li><li>Good, because consolidates all cloud resources on single provider (unified billing, IAM, monitoring)</li><li>Good, because leverages existing GCP expertise and Terraform modules</li><li>Good, because Cloud Monitoring/Logging already configured for other services</li><li>Good, because Secret Manager integration for WireGuard key storage</li><li>Good, because e2-micro instance size is sufficient for network boot workload</li><li>Good, because low cost (~$10/month for self-managed WireGuard)</li><li>Good, because VPC networking is familiar and well-documented</li><li>Neutral, because requires self-managed WireGuard (no native support, same as AWS)</li><li>Neutral, because TFTP/HTTP/HTTPS served directly from VM (no special GCP features needed)</li><li>Bad, because slightly more expensive than AWS t4g.micro (~$6.50/month vs ~$6/month)</li><li>Bad, because creates vendor lock-in to GCP ecosystem</li><li>Bad, because Cloud VPN (managed IPsec) is expensive (~$73/month), so must use self-managed WireGuard</li></ul><h3 id=option-2-amazon-web-services-aws>Option 2: Amazon Web Services (AWS)</h3><p>Host network boot infrastructure on Amazon Web Services.</p><h4 id=architecture-overview-1>Architecture Overview</h4><pre class=mermaid>graph TB
    subgraph &#34;Home Lab Network&#34;
        A[Home Lab Servers]
        B[UDM Pro - WireGuard Client]
    end
    
    subgraph &#34;AWS VPC&#34;
        C[WireGuard Gateway EC2&lt;br/&gt;t4g.micro]
        D[Boot Server EC2&lt;br/&gt;t4g.micro]
        C --&gt;|VPC Routing| D
    end
    
    A --&gt;|PXE Boot Request| B
    B --&gt;|WireGuard Tunnel| C
    C --&gt;|TFTP/HTTP/HTTPS| D
    D --&gt;|Boot Files| C
    C --&gt;|Encrypted Response| B
    B --&gt;|Boot Files| A</pre><h4 id=implementation-details-1>Implementation Details</h4><p><strong>Compute</strong>:</p><ul><li><strong>WireGuard Gateway</strong>: t4g.micro EC2 (~$6/month, ARM-based Graviton)<ul><li>Self-managed WireGuard server</li><li>Source/Dest check disabled for IP forwarding</li><li>Elastic IP (free when attached to running instance)</li></ul></li><li><strong>Boot Server</strong>: t4g.micro EC2 (same or consolidated with gateway)<ul><li>TFTP server (<code>tftpd-hpa</code>)</li><li>HTTP server (nginx)</li><li>Optional HTTPS with Let&rsquo;s Encrypt or self-signed cert</li></ul></li></ul><p><strong>Networking</strong>:</p><ul><li><strong>VPC</strong>: Default VPC or custom VPC with private subnets</li><li><strong>Security Groups</strong>:<ul><li>WireGuard SG: Allow UDP/51820 from home lab public IP</li><li>Boot Server SG: Allow UDP/69, TCP/80, TCP/443 from WireGuard SG</li></ul></li><li><strong>Route Table</strong>: Add route for home lab subnet via WireGuard instance</li><li><strong>Site-to-Site VPN</strong>: Not used (self-managed WireGuard saves ~$30/month)</li></ul><p><strong>WireGuard Setup</strong>:</p><ul><li>Install WireGuard on Ubuntu 22.04 or Amazon Linux 2023 EC2</li><li>Configure <code>wg0</code> with iptables MASQUERADE</li><li>Store private key in Secrets Manager</li><li>UDM Pro connects as WireGuard peer</li></ul><p><strong>Cost Breakdown</strong> (US East):</p><table><thead><tr><th>Component</th><th>Monthly Cost</th></tr></thead><tbody><tr><td>t4g.micro EC2 (WireGuard + Boot)</td><td>~$6.00</td></tr><tr><td>Elastic IP (attached)</td><td>$0.00</td></tr><tr><td>Egress (10 boots × 150MB)</td><td>~$0.09</td></tr><tr><td><strong>Total (On-Demand)</strong></td><td><strong>~$6.09</strong></td></tr><tr><td><strong>Total (1-yr Reserved)</strong></td><td><strong>~$3.59</strong></td></tr><tr><td><strong>Annual (On-Demand)</strong></td><td><strong>~$73</strong></td></tr><tr><td><strong>Annual (Reserved)</strong></td><td><strong>~$43</strong></td></tr></tbody></table><h4 id=pros-and-cons-1>Pros and Cons</h4><ul><li>Good, because t4g.micro ARM instances offer best price/performance (~$6/month on-demand)</li><li>Good, because Reserved Instances provide significant savings (~40% with 1-year commitment)</li><li>Good, because Elastic IP is free when attached to running instance</li><li>Good, because AWS has extensive documentation and community support</li><li>Good, because potential for future multi-cloud strategy</li><li>Good, because ACM provides free SSL certificates (if public domain used)</li><li>Good, because Secrets Manager for WireGuard key storage</li><li>Good, because low cost (~$6/month on-demand, ~$3.50/month with RI)</li><li>Neutral, because requires self-managed WireGuard (no native support, same as GCP)</li><li>Neutral, because TFTP/HTTP/HTTPS served directly from EC2 (no special AWS features)</li><li>Bad, because introduces multi-cloud complexity (separate billing, IAM, monitoring)</li><li>Bad, because no existing AWS infrastructure in home lab (new learning curve)</li><li>Bad, because requires separate monitoring/logging setup (CloudWatch vs Cloud Monitoring)</li><li>Bad, because separate Terraform state and modules needed</li><li>Bad, because Site-to-Site VPN is expensive (~$36/month), so must use self-managed WireGuard</li></ul><h2 id=more-information>More Information</h2><h3 id=detailed-analysis>Detailed Analysis</h3><p>For in-depth analysis of each provider&rsquo;s capabilities:</p><ul><li><p><a href=../analysis/google-cloud/><strong>Google Cloud Platform Analysis</strong></a></p><ul><li><a href=../analysis/google-cloud/network-boot/>Network Boot Protocol Support (TFTP, HTTP, HTTPS)</a></li><li><a href=../analysis/google-cloud/wireguard/>WireGuard VPN Support and Deployment</a></li></ul></li><li><p><a href=../analysis/aws/><strong>Amazon Web Services Analysis</strong></a></p><ul><li><a href=../analysis/aws/network-boot/>Network Boot Protocol Support (TFTP, HTTP, HTTPS)</a></li><li><a href=../analysis/aws/wireguard/>WireGuard VPN Support and Deployment</a></li></ul></li></ul><h3 id=key-findings-summary>Key Findings Summary</h3><p>Both providers offer:</p><ul><li>✅ <strong>TFTP Support</strong>: Via direct VM/EC2 access (load balancers don&rsquo;t support TFTP)</li><li>✅ <strong>HTTP/HTTPS Support</strong>: Full support via direct VM/EC2 or load balancers</li><li>✅ <strong>WireGuard Compatibility</strong>: Self-managed deployment on VM/EC2 (neither has native support)</li><li>✅ <strong>UDM Pro Integration</strong>: Native WireGuard client works with both</li><li>✅ <strong>Low Cost</strong>: $6-12/month for compute + VPN infrastructure</li><li>✅ <strong>Sufficient Performance</strong>: 100+ Mbps throughput on smallest instances</li></ul><p>Key differences:</p><ul><li><strong>GCP</strong>: Slightly higher cost (~$10/month), but consolidates with existing infrastructure</li><li><strong>AWS</strong>: Slightly lower cost (~$6/month on-demand, ~$3.50/month Reserved), but introduces multi-cloud complexity</li></ul><h3 id=cost-comparison-table>Cost Comparison Table</h3><table><thead><tr><th>Component</th><th>GCP (e2-micro)</th><th>AWS (t4g.micro On-Demand)</th><th>AWS (t4g.micro 1-yr RI)</th></tr></thead><tbody><tr><td>Compute</td><td>$6.50/month</td><td>$6.00/month</td><td>$3.50/month</td></tr><tr><td>Static IP</td><td>$3.50/month</td><td>$0.00 (Elastic IP free when attached)</td><td>$0.00</td></tr><tr><td>Egress (1.5GB)</td><td>$0.18/month</td><td>$0.09/month</td><td>$0.09/month</td></tr><tr><td><strong>Monthly</strong></td><td><strong>$10.18</strong></td><td><strong>$6.09</strong></td><td><strong>$3.59</strong></td></tr><tr><td><strong>Annual</strong></td><td><strong>$122</strong></td><td><strong>$73</strong></td><td><strong>$43</strong></td></tr></tbody></table><p><strong>Savings Analysis</strong>: AWS is ~$49-79/year cheaper, but introduces operational complexity.</p><h3 id=protocol-support-comparison>Protocol Support Comparison</h3><table><thead><tr><th>Protocol</th><th>GCP Support</th><th>AWS Support</th><th>Implementation</th></tr></thead><tbody><tr><td>TFTP (UDP/69)</td><td>⚠️ Via VM</td><td>⚠️ Via EC2</td><td>Direct VM/EC2 access (no LB support)</td></tr><tr><td>HTTP (TCP/80)</td><td>✅ Full</td><td>✅ Full</td><td>Direct VM/EC2 or Load Balancer</td></tr><tr><td>HTTPS (TCP/443)</td><td>✅ Full</td><td>✅ Full</td><td>Direct VM/EC2 or Load Balancer + cert</td></tr><tr><td>WireGuard</td><td>⚠️ Self-managed</td><td>⚠️ Self-managed</td><td>Install on VM/EC2</td></tr></tbody></table><h3 id=wireguard-deployment-comparison>WireGuard Deployment Comparison</h3><table><thead><tr><th>Aspect</th><th>GCP</th><th>AWS</th></tr></thead><tbody><tr><td><strong>Native Support</strong></td><td>❌ No (IPsec Cloud VPN only)</td><td>❌ No (IPsec Site-to-Site VPN only)</td></tr><tr><td><strong>Self-Managed</strong></td><td>✅ Compute Engine</td><td>✅ EC2</td></tr><tr><td><strong>Setup Complexity</strong></td><td>Similar (install, configure, firewall)</td><td>Similar (install, configure, SG)</td></tr><tr><td><strong>IP Forwarding</strong></td><td>Enable on VM</td><td>Disable Source/Dest check</td></tr><tr><td><strong>Firewall</strong></td><td>VPC Firewall rules</td><td>Security Groups</td></tr><tr><td><strong>Key Storage</strong></td><td>Secret Manager</td><td>Secrets Manager</td></tr><tr><td><strong>Cost</strong></td><td>~$10/month total</td><td>~$6/month total</td></tr></tbody></table><h3 id=trade-offs-analysis>Trade-offs Analysis</h3><p><strong>Choosing GCP</strong>:</p><ul><li><strong>Wins</strong>: Operational simplicity, unified infrastructure, existing expertise</li><li><strong>Loses</strong>: ~$50-80/year higher cost, vendor lock-in</li></ul><p><strong>Choosing AWS</strong>:</p><ul><li><strong>Wins</strong>: Lower cost, Reserved Instance savings, multi-cloud optionality</li><li><strong>Loses</strong>: Multi-cloud complexity, separate monitoring/billing, new tooling</li></ul><p>For a home lab prioritizing <strong>simplicity over cost optimization</strong>, GCP&rsquo;s consolidation benefits outweigh the modest cost difference.</p><h3 id=related-adrs>Related ADRs</h3><ul><li><a href=./0002-network-boot-architecture/>ADR-0002: Network Boot Architecture</a> - Established requirement for cloud-hosted boot server with VPN</li><li><a href=./0001-use-madr-for-architecture-decision-records/>ADR-0001: Use MADR for Architecture Decision Records</a> - MADR format used for this ADR</li></ul><h3 id=future-considerations>Future Considerations</h3><ol><li><strong>Cost Reevaluation</strong>: If annual costs become significant, reconsider AWS Reserved Instances</li><li><strong>Multi-Cloud</strong>: If multi-cloud strategy emerges, migrate boot server to AWS</li><li><strong>Managed WireGuard</strong>: If GCP or AWS adds native WireGuard support, reevaluate managed option</li><li><strong>High Availability</strong>: If HA required, evaluate multi-region deployment costs on both providers</li></ol><h3 id=related-issues>Related Issues</h3><ul><li><a href=https://github.com/Zaba505/infra/issues/597>Issue #597</a> - story(docs): create adr for cloud provider selection</li></ul><div class=td-page-meta__lastmod>Last modified November 23, 2025: <a data-proofer-ignore href=https://github.com/Zaba505/infra/commit/cd6b05bc19e71e535c2170b095d477372e75bce7>Merge a2a6845a2382fd5c69ac0f96bc11edfd508dfaf1 into 0365091529941d020b104dd5b7694d85078e5b00 (cd6b05b)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/Zaba505/infra aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024&ndash;2025
<span class=td-footer__authors>Zaba505 | <a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script type=module async>
  import mermaid from "https:\/\/cdn.jsdelivr.net\/npm\/mermaid@latest\/dist\/mermaid.esm.min.mjs";

  (function ($) {
    if ($('.mermaid').length == 0) {
      mermaid.initialize({ startOnLoad: false });
      return;
    }

    var params = {};

    
    
    var norm = function (defaultConfig, params) {
      var result = {};
      for (const key in defaultConfig) {
        const keyLower = key.toLowerCase();
        if (defaultConfig.hasOwnProperty(key) && params.hasOwnProperty(keyLower)) {
          if (typeof defaultConfig[key] === "object") {
            result[key] = norm(defaultConfig[key], params[keyLower]);
          } else {
            result[key] = params[keyLower];
          }
        }
      }
      return result;
    };

    var settings = norm(mermaid.mermaidAPI.defaultConfig, params);
    settings.startOnLoad = true;
    if ($('html[data-bs-theme="dark"]').length) {
      settings.theme = 'dark';
    }
    mermaid.initialize(settings);

    
    const lightDarkModeThemeChangeHandler = function (mutationsList, observer) {
      for (const mutation of mutationsList) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-bs-theme') {
          
          
          
          location.reload();
        }
      }
    };

    const observer = new MutationObserver(lightDarkModeThemeChangeHandler);
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-bs-theme']
    });
    

  })(jQuery);
</script><script src=/infra/pr-preview/pr-626/js/main.min.eb40505784d893e4b5c8dbd67b59c353e735d847f4ffbfe9d6921dec08dbacba.js integrity="sha256-60BQV4TYk+S1yNvWe1nDU+c12Ef0/7/p1pId7AjbrLo=" crossorigin=anonymous></script><script defer src=/infra/pr-preview/pr-626/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/infra/pr-preview/pr-626/js/tabpane-persist.js></script></body></html>