<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Boot Service on Zaba505's Home Lab</title><link>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/</link><description>Recent content in Boot Service on Zaba505's Home Lab</description><generator>Hugo</generator><language>en-us</language><atom:link href="https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/index.xml" rel="self" type="application/rss+xml"/><item><title>UEFI HTTP Boot Endpoints</title><link>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/uefi-boot-endpoints/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/uefi-boot-endpoints/</guid><description>&lt;p&gt;These endpoints are accessed by bare metal servers (HP DL360 Gen 9) during the UEFI HTTP boot process. All endpoints are accessed through the WireGuard VPN tunnel and use source IP validation for security.&lt;/p&gt;
&lt;h2 id="boot-script-endpoint"&gt;Boot Script Endpoint&lt;/h2&gt;
&lt;h3 id="get-bootipxe"&gt;&lt;code&gt;GET /boot.ipxe&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Serves iPXE boot scripts customized for the requesting machine based on its MAC address.&lt;/p&gt;
&lt;h4 id="sequence-diagram"&gt;Sequence Diagram&lt;/h4&gt;
&lt;pre class="mermaid"&gt;sequenceDiagram
 participant Client as Bare Metal Server
 participant Boot as Boot Service
 participant MachineAPI as Machine Service
 participant DB as Firestore
 
 Client-&amp;gt;&amp;gt;Boot: GET /boot.ipxe?mac=52:54:00:12:34:56
 Boot-&amp;gt;&amp;gt;Boot: Validate MAC address format
 Boot-&amp;gt;&amp;gt;MachineAPI: GET /api/v1/machines?mac=52:54:00:12:34:56
 MachineAPI-&amp;gt;&amp;gt;DB: Query machine by NIC MAC
 DB--&amp;gt;&amp;gt;MachineAPI: Machine profile (machine_id)
 MachineAPI--&amp;gt;&amp;gt;Boot: Machine profile
 Boot-&amp;gt;&amp;gt;DB: Query boot profile by machine_id
 DB--&amp;gt;&amp;gt;Boot: Boot profile (profile_id, kernel_id, initrd_id, kernel args)
 Boot-&amp;gt;&amp;gt;Boot: Generate iPXE script with profile_id
 Boot--&amp;gt;&amp;gt;Client: 200 OK (iPXE script)&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Query Parameters:&lt;/strong&gt;&lt;/p&gt;</description></item><item><title>Boot Service Admin API</title><link>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/admin-api/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/admin-api/</guid><description>&lt;p&gt;The Boot Service provides admin HTTP REST endpoints for managing boot profiles. Boot profiles bundle kernel, initrd, and kernel arguments together. Each machine has exactly one active boot profile at any given time.&lt;/p&gt;
&lt;h2 id="boot-profile-management"&gt;Boot Profile Management&lt;/h2&gt;
&lt;h3 id="cloud-storage-structure"&gt;Cloud Storage Structure&lt;/h3&gt;
&lt;p&gt;Kernel and initrd binaries are stored in Google Cloud Storage using their UUIDv7 identifiers as object keys:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;gs://{bucket}/blobs/{kernel_id}
gs://{bucket}/blobs/{initrd_id}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For example:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;gs://boot-server-blobs/blobs/018c7dbd-b100-7000-8000-123456789abc
gs://boot-server-blobs/blobs/018c7dbd-b200-7000-8000-987654321fed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The UUIDv7 identifiers are generated server-side during upload, ensuring:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Globally unique object keys&lt;/li&gt;
&lt;li&gt;Time-ordered storage (UUIDv7 timestamp prefix)&lt;/li&gt;
&lt;li&gt;No namespace collisions between profiles&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="post-apiv1profiles"&gt;&lt;code&gt;POST /api/v1/profiles&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Create a new boot profile for a machine. If the machine already has a boot profile, this operation will fail - use PUT to update instead.&lt;/p&gt;</description></item><item><title>Health Check Endpoints</title><link>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/health-checks/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://zaba505.github.io/infra/pr-preview/pr-626/rd/services/boot/health-checks/</guid><description>&lt;p&gt;The Boot Server exposes standard health check endpoints used by GCP Cloud Run for startup and liveness probes. These endpoints are unauthenticated and accessible without VPN access.&lt;/p&gt;
&lt;h2 id="startup-probe"&gt;Startup Probe&lt;/h2&gt;
&lt;h3 id="get-healthstartup"&gt;&lt;code&gt;GET /health/startup&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Indicates whether the application has completed initialization and is ready to receive traffic.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Request Example:&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-http" data-lang="http"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nf"&gt;GET&lt;/span&gt; &lt;span class="nn"&gt;/health/startup&lt;/span&gt; &lt;span class="kr"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1.1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;boot.example.com&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Response (200 OK):&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Empty response body with HTTP 200 status code.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Response (503 Service Unavailable):&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Empty response body with HTTP 503 status code.&lt;/p&gt;</description></item></channel></rss>